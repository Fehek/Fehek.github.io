---
title: 计算机网网络
abbrlink: 71c437b1
date: 2021-01-18 09:50:00
tags:
categories: 计算机网络
index_img:
banner_img:
---

# 分类
名称|英语|范围|区域
:-:|:-:|:-:|:-:
广域网|WAN(Wide Area NetWork)|几十到几千公里|跨省、跨国
城域网|MAN(Metro Area NetWork)|5KM-50KM|城市间
局域网|LAN(Local Area NetWork)|1KM以内|城区内

# 模型
OSI 七层模型|作用
:-|:-
应用层|为计算机用户提供接口和服务
表示层|数据处理（编码解码、加密解密等）
会话层|管理（建立、维护、重连）通信会话
传输层|管理端到端的通信连接
网络层|数据路由（决定数据在网络的路径）
数据链路层|管理相邻节点之间的数据通信
物理层|数据通信的光电物理特性

OSI最终并没有成为广为使用的标准模型

TCP/IP 四层模型|协议
:-|:-
应用层|HTTP/FTP/SMTP/POP3...
传输层|TCP/UDP
网络层|IP/ICMP
网络接口层|Ethernet/ARP/RARP/PPP...

# 网络接口层
## 物理层
**性能指标**
- 为什么拉的 100M 光纤，测试峰值只有12M/s?
网络常用单位为 Mbps，bps = bit/s
100M/s = 100Mbps = 100Mbit/s
100Mbit/s = (100/8)MB/s = 12.5MB/s

- 时延
发送时延 = 数据长度(bit) / 发送速率(bit/s)[受限于计算机网卡]
传播时延 = 传输路径距离 / 传播速率(bit/s)[受限于传播介质]
排队时延：数据包在网络设备中等待被处理的时间
处理时延：数据包到达设备或者目的机器被处理所需要的时间
总时延 = 发送时延 + 传播时延 + 排队时延 + 处理时延

- 往返时间RTT(Route-Trip Time)
数据报文在端到端通信中的来回一次的时间
通常使用 ping 命令查看 RTT

## 数据链路层
### 过程
1. 封装成帧
“帧”是数据链路层数据的基本单位
发送端在网络层的一段数据前后添加特定标记形成“帧”
接收端根据前后特定标记识别出“帧”<br>
帧首部(SOH) | IP数据报（“帧”的数据）| 帧尾部(EOT)
帧首部和尾部是特定的控制字符（特定比特流）
SOH: 00000001
EOT: 00000100

2. 透明传输
控制字符在帧数据中，要当做不存在去处理<br>
数据里面恰好有这些比特流怎么办？
在前面加一个转义字符(ESC)

3. 差错检测
- 奇偶校验码：出现偶数个错误，检测不到错误
- 循环冗余校验码CRC：一种根据传输或保存的数据而产生固定位数校验码的方法，检测数据传输或者保存后可能出现的错误生成的数字计算出来并且附加到数据后面。
CRC的错误检测能力与位串的阶数r有关
数据链路层只进行数据的检测，不进行纠正
CRC可校验位串：
  1. 选择一个用于校验的多项式G(x)，并在数据尾部添加r个0
  2. 将添加r个0后的数据，使用模“2”除法除以多项式的位串
  3. 得到的余数填充在原数据r个0的位置得到可校验的位串
模“2”除法：是二进制下的除法；与算术除法类似，但除法不借位，实际是“异或”操作

e.g. 使用CRC计算101001的可校验位串
G(x) = x<sup>3</sup> + x<sup>2</sup> + 1
G(x) = 1 * x<sup>3</sup> + 1 * x<sup>2</sup> + 0 * x + 1
=> 二进制位串：1101，最高阶3 => 原来的数尾部添加3个0，101001000
101001000 模“2”除法除以 1101 => 得到余数 001
余数填充在最后3位，101001000 => 可校验位串101001001
接收端接收的数据除以G(x)的位串（101001001 / 1101），余数为 0 则没有出错

### MTU
最大传输单元MTU(Maximum Transmission Unit)
数据链路层的数据帧也不是无限大的，数据帧长度受MTU限制
数据帧过大或过小都会影响传输的效率，以太网MTU一般为1500字节

路径MTU：路径MTU由链路中MTU的最小值决定（木桶效应）

### MAC地址
MAC地址（物理地址、硬件地址）
每一个设备都拥有唯一的MAC地址
MAC地址共48位，使用十六进制表示
查看计算机的MAC地址：`ipconfig /all`，例 68-07-15-6F-54-F0

### 以太网协议
以太网(Ethernet)是一种使用广泛的**局域网**技术
以太网是一种应用于数据链路层的协议
使用以太网可以完成**相邻设备**的数据帧传输

目的地址|源地址|类型|帧数据|CRC
:-:|:-:|:-:|:-:|:-:
6|6|2|46~1500|4

目标地址和源地址都是MAC地址，48位即6字节

类型<br>0800|IP数据报
:-:|:-:

类型<br>0806|APR请求/应答|PAD
:-:|:-:|:-:
2|28|18

类型<br>8035|RAPR请求/应答|PAD
:-:|:-:|:-:
2|28|18

MAC地址会映射到具体接口，例如下面的MAC地址表

MAC地址|硬件接口
:-:|:-:
68-07-15-6F-54-F0|接口1
68-07-15-6F-54-F1|接口2
68-07-15-6F-54-F2|接口4
...|...

A设备通过网卡发出数据帧
数据帧达到路由器，路由器取出前6字节
路由器匹配MAC地址表，找到对应的网络接口
路由器往该网络接口发送数据帧

E(路由器)检查MAC地址表，发现没有C的信息
E将广播A的数据包到除A以外的端口
E将受到来自B、C的回应，并将地址记录

它能实现相邻物理节点传输。
但是怎么跨设备传输呢？需要网络层才能解决。

# 网络层